const sendTelegramMessage=async e=>{if(!e||e.value.length<=0)return e.classList.add("invalid"),!1;e.classList.remove("invalid");var t="Новий запит на консультацію! Номер телефона: "+e.value;try{if((await(await fetch("api/telegram.php",{method:"POST",headers:{"X-Requested-With":"xmlhttprequest","Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({message:t})})).json()).ok)return!(e.value="");throw"Request failed"}catch(e){return console.error("Error while sending message: "+e),!1}},createPayment=async()=>{try{var e=await(await fetch("api/payment.php",{method:"GET",headers:{"X-Requested-With":"xmlhttprequest",Accept:"application/json"}})).json();if(!e.response||"success"!==e.response.response_status)throw"Request failed";if(!e.response.checkout_url)throw"No checkout url returned";window.location.href=e.response.checkout_url}catch(e){console.error("Error while sending payment: "+e)}},initializePayments=()=>{var e=document.querySelector(".telegramButton_pay");if(e){const t=e.parentNode.querySelector("input[name=phone_number]");e.addEventListener("click",async e=>{e.preventDefault(),await sendTelegramMessage(t)&&createPayment()})}else console.log("Initializing error. Payment button not found")},initializeMessages=()=>{var e=document.querySelector(".telegramButton");if(e){const t=e.parentNode.querySelector("input[name=phone_number]");e.addEventListener("click",e=>{e.preventDefault(),sendTelegramMessage(t)})}else console.log("Initializing error. Telegram button not found")};document.addEventListener("DOMContentLoaded",()=>{initializePayments(),initializeMessages()});